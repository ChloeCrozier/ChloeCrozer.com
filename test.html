
<script>
const books = [
  'Genesis', 'Exodus', 'Leviticus', 'Numbers', 'Deuteronomy', 'Joshua', 'Judges', 'Ruth', '1Samuel', '2Samuel', '1Kings', '2Kings', '1Chronicles', '2Chronicles', 'Ezra', 'Nehemiah', 'Esther', 'Job', 'Psalms', 'Proverbs', 'Ecclesiastes', 'Song of Solomon', 'Isaiah', 'Jeremiah', 'Lamentations', 'Ezekiel', 'Daniel', 'Hosea', 'Joel', 'Amos', 'Obadiah', 'Jonah', 'Micah', 'Nahum', 'Habakkuk', 'Zephaniah', 'Haggai', 'Zechariah', 'Malachi', 'Matthew', 'Mark', 'Luke', 'John', 'Acts', 'Romans', '1Corinthians', '2Corinthians', 'Galatians', 'Ephesians', 'Philippians', 'Colossians', '1Thessalonians', '2Thessalonians', '1Timothy', '2Timothy', 'Titus', 'Philemon', 'Hebrews', 'James', '1Peter', '2Peter', '1John', '2John', '3John', 'Jude', 'Revelation'
];
const bookSelectElement = document.querySelector('#books');
const randomButton = document.querySelector('#random-button');



// Dynamically populate the select element...
bookSelectElement.innerHTML += books.map(book => `<option value="${book}">${book}</option>`).join('');

//
// EVENT LISTENERS
//
bookSelectElement.addEventListener('change', event => {
  generateOutput(event.target.value, '#selection-output');
});
randomButton.addEventListener('click', event => {
  const randomBook = books[Math.floor(Math.random() * books.length)];
  generateOutput(randomBook, '#random-output');
});

//
// SHARED UTILITY FUNCTIONS
//
function fetchVerseFromAPI (reference) {
  return fetchJsonp(`https://getbible.net/json?passage=${reference}`)
    .then(response => response.json())
    .catch(error => {
      console.error('Error getting the verse...', error);
    });
}

function generateOutput (book, outputSelector) {
  const { chapters, name, order, versesPerChapter } = chapterAndVerse(book).book;
  const randomChapter = Math.floor(Math.random() * chapters);
  const randomVerse = Math.floor((Math.random() * versesPerChapter[randomChapter]) + 1);
  const reference = `${book} ${randomChapter + 1}:${randomVerse}`;

  fetchVerseFromAPI(reference).then(result => {
    const { verse: text } = Object.values(result.book[0].chapter)[0];

    document.querySelector(outputSelector).innerHTML = `
      <h2>${reference}</h2>
      <p>${text}</p>
    `;
  });
}
</script>